# Jenkins

Jenkins is a self-contained, open source automation server, which can be used to automate the building, testing, and deployment of software.

It can installed standalone on a system, or work with tools like Docker

## Jenkins Projects, Jobs, and Builds

In Jenkins you work with Projects/Jobs:
- Each job is a repeatable set of steps that automate a task
- You can trigger your jobs manually, externally, or by other jobs
- When a job is triggered, it create a build

Jobs have status called Health. The health is represented by a weather condition
- Sunny: 81% or more build passed
- Partially Sunny: 61 - 80% passed
- Cloudy: 41 - 60% passed
- Raining: 21 - 40% passed
- Stormy: 20% or less passed

Builds have a more traditional status, each one gets a colored circle representing success or failure
- Blue: success
- Yellow: unstable
- Red: Failure
- Gray: No builds/aborted build

## Jenkins Pipeline Setup with Github

1. SSH into the VM instance

2. Install Java

- `sudo yum install openjdk-11-jdk`

3. Install Docker

- `sudo yum install docker`
- `sudo systemctl enable docker.service`
- `sudo systemctl start docker.service`

4. Start jenkins

- `sudo docker run -d -p 8080:8080 -p 50000:50000 jenkins/jenkins`

5. Get the name of the Jenkins container

- `sudo docker ps -a`

6. Get the jenkins admin password

- `sudo docker exec -t -i <container-name> cat /var/jenkins_home/secrets/initialAdminPassword`

7. Put in the password then setup jenkins

-   Choose install sugested plugins
-   Skip and continue as admin
-   Not now
-   Start using Jenkins

8. Create a Github pipeline

-   Got to your github repo page then go to Webhooks > Add Webhook

-   Set payload URL to http://EC2IP:8080/github-webhook/

-   Set the content type to application/json

-   Choose `Let me select individual events`

    -   Pull Requests, Pushes

-   Add Webhook

-   If the delivery fails, try to fix the issue and redeliver

9. Create the Jenkins Job

New Item > Name it > Free Style Project > OK

-   Description > Can be literally anything

-   Source Code Management > Git > Paste the URL to the Repo

-   Branches to Build > \*/main

-   Build triggers > Github hook trigger for GitScm polling

-   Build > Add Build Step > Execute Shell

10. Setup the Execute shell

-   Start with `ls` to see the package structure from github

- ```
  ls
  chmod +x mvnw
  ./mvnw clean install
  ```

11. After the build succeeds we will put the project on the ec2 instance, since our docker container should be just for running jenkins

- `sudo docker cp <container-name>:/var/jenkins_home/workspace/<job-name>/target ~/demo`

12. Be sure to setup any environment variables needed to connect to apis or databases on the ec2 instance before running the jar

13. Run the jar

- `java -jar GroceryListSpringBoot-0.0.1-SNAPSHOT.jar`

# SonarCloud/SonarLint

SonarCloud and SonarLint are code quality analysis tools which increase the readablity, security, and maintainability of code

These tools can help produce higher quality code, and provide standardization between developers

Code Quality Analysis tools are programs specifically designed to expose errors as well as code smells

- Code Smells: Charachteristics of the code that while not actually preventing proper functionality, they may enventaully prevent the maintainablity of you code
- Vulnerabilities: data security issues
- Bugs: issues with the actual code functionality
- Maintainability Issues:
    - Confusing or hard to maintain code
    - Repeated Instances of code
    - Unused imports
    - Empty code blocks
    - Unaddressed automated code comments

SonarCloud is a cloud based review solution which can be configured to review code witin a cloud repositotr, such as Github

How to setup Sonar Cloud: https://sonarcloud.io/documentation/getting-started/github/

Sonar Lint is a free, opensource linting tool which you can install directly into your IDE

Traditional IDE's use some sort of linter, but Sonar Lint provides further linting as listed above

To install on Eclipse/STS, you can simply go to the market place and search for Sonar Lint and install